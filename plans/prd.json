{
  "projectName": "Brain Dump",
  "projectPath": "/Users/salman.rana/code/brain-dump",
  "testingRequirements": [
    "Tests must validate user-facing behavior, not implementation details",
    "Focus on what users actually do - integration tests over unit tests",
    "Don't mock excessively - test real behavior where possible",
    "Coverage metrics are meaningless - user flow coverage is everything"
  ],
  "userStories": [
    {
      "id": "251af0d1-2805-4d7e-9e48-056c53ba7e37",
      "title": "55 - Create CreateTicketModal shell",
      "passes": true,
      "overview": "",
      "types": [],
      "designDecisions": [],
      "implementationGuide": [],
      "acceptanceCriteria": [
        "Uses Modal base component",
        "2-column layout for form fields",
        "Modal.Header with \"Create New Ticket\" title",
        "Modal.Body with form",
        "Modal.Footer with Cancel/Create buttons",
        "Opens from NewTicketDropdown",
        "Escape closes modal"
      ],
      "references": [
        "src/components/tickets/CreateTicketModal.tsx"
      ],
      "description": "Create the Create Ticket modal with 2-column form layout.\n\n**Files to Create:**\n- `src/components/tickets/CreateTicketModal.tsx`\n\n**Acceptance Criteria:**\n- [ ] Uses Modal base component\n- [ ] 2-column layout for form fields\n- [ ] Modal.Header with \"Create New Ticket\" title\n- [ ] Modal.Body with form\n- [ ] Modal.Footer with Cancel/Create buttons\n- [ ] Opens from NewTicketDropdown\n- [ ] Escape closes modal\n\n**Layout:**\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ [ğŸ“] Create New Ticket                                   [Ã—] â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ Title *                                                      â”‚\nâ”‚ [_________________________________________________]          â”‚\nâ”‚                                                              â”‚\nâ”‚ Description                                                  â”‚\nâ”‚ [_________________________________________________]          â”‚\nâ”‚ [_________________________________________________]          â”‚\nâ”‚                                                              â”‚\nâ”‚ Project *              â”‚ Priority                           â”‚\nâ”‚ [Project â–¾]            â”‚ [Priority â–¾]                       â”‚\nâ”‚                                                              â”‚\nâ”‚ Epic                   â”‚ Tags                               â”‚\nâ”‚ [Epic â–¾]               â”‚ [+tag] [+tag]                      â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚                               [Cancel]  [Create Ticket]      â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n**Tests:** Visual inspection",
      "priority": "high",
      "tags": [
        "modal",
        "ticket",
        "form"
      ]
    },
    {
      "id": "98330174-2394-4d71-aade-d700c2ae1bf5",
      "title": "56 - Add form fields to CreateTicketModal",
      "passes": true,
      "overview": "",
      "types": [],
      "designDecisions": [],
      "implementationGuide": [],
      "acceptanceCriteria": [
        "Title input (required, text)",
        "Description textarea (optional, multiline)",
        "Project select (required, dropdown)",
        "Priority select (optional, dropdown: low/medium/high)",
        "Epic select (optional, filtered by project)",
        "Tags input (optional, multi-select)",
        "Form state management (controlled)",
        "All fields accept input",
        "Project select populates"
      ],
      "references": [
        "src/components/tickets/CreateTicketModal.tsx"
      ],
      "description": "Implement all form fields for ticket creation.\n\n**Files to Modify:**\n- `src/components/tickets/CreateTicketModal.tsx`\n\n**Acceptance Criteria:**\n- [ ] Title input (required, text)\n- [ ] Description textarea (optional, multiline)\n- [ ] Project select (required, dropdown)\n- [ ] Priority select (optional, dropdown: low/medium/high)\n- [ ] Epic select (optional, filtered by project)\n- [ ] Tags input (optional, multi-select)\n- [ ] Form state management (controlled)\n\n**Form Fields:**\n```tsx\ninterface CreateTicketForm {\n  title: string;        // required\n  description: string;  // optional\n  projectId: string;    // required\n  priority: 'low' | 'medium' | 'high';  // default: medium\n  epicId: string | null;  // optional\n  tags: string[];       // optional\n}\n```\n\n**E2E Tests:**\n- [ ] All fields accept input\n- [ ] Project select populates",
      "priority": "high",
      "tags": [
        "modal",
        "ticket",
        "form"
      ]
    },
    {
      "id": "cc14ddf1-d01f-4ea3-82d1-8b3105ec8caa",
      "title": "57 - Create EpicSelect component with project filtering",
      "passes": true,
      "overview": "",
      "types": [],
      "designDecisions": [],
      "implementationGuide": [],
      "acceptanceCriteria": [
        "Dropdown of epics filtered by projectId",
        "Disabled when no project selected",
        "\"No epic\" option to clear selection",
        "\"Create New Epic\" option at bottom",
        "Updates when project changes",
        "Shows epic color indicator",
        "Disabled when no project",
        "Filters correctly by project",
        "Create epic opens modal"
      ],
      "references": [
        "src/components/tickets/EpicSelect.tsx",
        "src/components/tickets/EpicSelect.test.tsx"
      ],
      "description": "Create epic selector that filters epics by selected project.\n\n**Files to Create:**\n- `src/components/tickets/EpicSelect.tsx`\n- `src/components/tickets/EpicSelect.test.tsx`\n\n**Acceptance Criteria:**\n- [ ] Dropdown of epics filtered by projectId\n- [ ] Disabled when no project selected\n- [ ] \"No epic\" option to clear selection\n- [ ] \"Create New Epic\" option at bottom\n- [ ] Updates when project changes\n- [ ] Shows epic color indicator\n\n**Interface:**\n```tsx\ninterface EpicSelectProps {\n  projectId: string | null;\n  value: string | null;\n  onChange: (epicId: string | null) => void;\n}\n```\n\n**Tests:**\n- [ ] Disabled when no project\n- [ ] Filters correctly by project\n- [ ] Create epic opens modal",
      "priority": "medium",
      "tags": [
        "component",
        "form"
      ]
    },
    {
      "id": "26f13880-179b-4957-b6d9-0da12613f037",
      "title": "58 - Create TagInput component",
      "passes": true,
      "overview": "",
      "types": [],
      "designDecisions": [],
      "implementationGuide": [],
      "acceptanceCriteria": [
        "Pills for each selected tag",
        "X button to remove tag",
        "Input field to add new tag",
        "Autocomplete from existing tags",
        "Enter adds tag",
        "Comma separates multiple tags",
        "Prevents duplicates",
        "Case-insensitive matching",
        "Add tag works",
        "Remove tag works",
        "Autocomplete shows",
        "No duplicates"
      ],
      "references": [
        "src/components/tickets/TagInput.tsx",
        "src/components/tickets/TagInput.test.tsx"
      ],
      "description": "Create tag input with add/remove pills and autocomplete.\n\n**Files to Create:**\n- `src/components/tickets/TagInput.tsx`\n- `src/components/tickets/TagInput.test.tsx`\n\n**Acceptance Criteria:**\n- [ ] Pills for each selected tag\n- [ ] X button to remove tag\n- [ ] Input field to add new tag\n- [ ] Autocomplete from existing tags\n- [ ] Enter adds tag\n- [ ] Comma separates multiple tags\n- [ ] Prevents duplicates\n- [ ] Case-insensitive matching\n\n**Layout:**\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ [auth Ã—] [backend Ã—] [_add tag...______] â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n  â”‚ api             â”‚  <- Autocomplete dropdown\n  â”‚ api-gateway     â”‚\n  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n**Tests:**\n- [ ] Add tag works\n- [ ] Remove tag works\n- [ ] Autocomplete shows\n- [ ] No duplicates",
      "priority": "medium",
      "tags": [
        "component",
        "form"
      ]
    },
    {
      "id": "5b653a12-4fe8-4365-8e5a-1500d2d62bc7",
      "title": "59 - Add form validation to CreateTicketModal",
      "passes": true,
      "overview": "",
      "types": [],
      "designDecisions": [],
      "implementationGuide": [],
      "acceptanceCriteria": [
        "Title required validation",
        "Project required validation",
        "Error messages below fields",
        "Red border on invalid fields",
        "Validate on blur",
        "Validate on submit",
        "Disable submit when invalid",
        "Focus first invalid field on submit",
        "Submit blocked without title",
        "Error message shows",
        "Valid form submits"
      ],
      "references": [
        "src/components/tickets/CreateTicketModal.tsx"
      ],
      "description": "Implement validation for required fields and error display.\n\n**Files to Modify:**\n- `src/components/tickets/CreateTicketModal.tsx`\n\n**Acceptance Criteria:**\n- [ ] Title required validation\n- [ ] Project required validation\n- [ ] Error messages below fields\n- [ ] Red border on invalid fields\n- [ ] Validate on blur\n- [ ] Validate on submit\n- [ ] Disable submit when invalid\n- [ ] Focus first invalid field on submit\n\n**Validation Rules:**\n```tsx\nconst rules = {\n  title: { required: 'Title is required', maxLength: 200 },\n  projectId: { required: 'Please select a project' },\n};\n```\n\n**Tests:**\n- [ ] Submit blocked without title\n- [ ] Error message shows\n- [ ] Valid form submits",
      "priority": "medium",
      "tags": [
        "validation",
        "form"
      ]
    },
    {
      "id": "8e1bc6a7-75b5-45c6-9866-8dcf68d88deb",
      "title": "60 - Implement submit with TanStack Query mutation",
      "passes": true,
      "overview": "",
      "types": [],
      "designDecisions": [],
      "implementationGuide": [],
      "acceptanceCriteria": [
        "Uses existing `createTicket` server function",
        "Shows loading state during submit",
        "Closes modal on success",
        "Shows success toast",
        "Invalidates tickets query (board updates)",
        "Shows error toast on failure",
        "Reset form on close",
        "Create ticket",
        "Appears on board",
        "Toast shows"
      ],
      "references": [
        "src/components/tickets/CreateTicketModal.tsx"
      ],
      "description": "Wire up form submission to create ticket via mutation.\n\n**Files to Modify:**\n- `src/components/tickets/CreateTicketModal.tsx`\n\n**Acceptance Criteria:**\n- [ ] Uses existing `createTicket` server function\n- [ ] Shows loading state during submit\n- [ ] Closes modal on success\n- [ ] Shows success toast\n- [ ] Invalidates tickets query (board updates)\n- [ ] Shows error toast on failure\n- [ ] Reset form on close\n\n**Implementation:**\n```tsx\nconst createMutation = useMutation({\n  mutationFn: createTicket,\n  onSuccess: () => {\n    queryClient.invalidateQueries({ queryKey: ['tickets'] });\n    toast.success('Ticket created!');\n    onClose();\n  },\n  onError: (err) => {\n    toast.error('Failed to create ticket');\n  },\n});\n```\n\n**E2E Tests:**\n- [ ] Create ticket\n- [ ] Appears on board\n- [ ] Toast shows",
      "priority": "high",
      "tags": [
        "mutation",
        "form"
      ]
    },
    {
      "id": "f7995df6-f90f-4e55-a4cf-e4df237f0820",
      "title": "61 - Create EditTicketModal shell",
      "passes": true,
      "overview": "",
      "types": [],
      "designDecisions": [],
      "implementationGuide": [],
      "acceptanceCriteria": [
        "Extends create modal layout",
        "Loads existing ticket data",
        "Prefills all form fields",
        "Modal.Header with \"Edit Ticket\" title",
        "Additional sections: Status, Blocked, Subtasks",
        "Delete button in footer (danger variant)",
        "Save Changes button"
      ],
      "references": [
        "src/components/tickets/EditTicketModal.tsx"
      ],
      "description": "Create the Edit Ticket modal extending the create modal pattern.\n\n**Files to Create:**\n- `src/components/tickets/EditTicketModal.tsx`\n\n**Acceptance Criteria:**\n- [ ] Extends create modal layout\n- [ ] Loads existing ticket data\n- [ ] Prefills all form fields\n- [ ] Modal.Header with \"Edit Ticket\" title\n- [ ] Additional sections: Status, Blocked, Subtasks\n- [ ] Delete button in footer (danger variant)\n- [ ] Save Changes button\n\n**Additional Sections vs Create:**\n- Status dropdown\n- Blocked toggle with reason\n- Subtasks list\n- Delete button\n\n**Tests:** Visual inspection",
      "priority": "high",
      "tags": [
        "modal",
        "ticket",
        "form"
      ]
    },
    {
      "id": "83fbabce-8989-4b42-baf6-05abda7e7673",
      "title": "62 - Add status dropdown to EditTicketModal",
      "passes": true,
      "overview": "",
      "types": [],
      "designDecisions": [],
      "implementationGuide": [],
      "acceptanceCriteria": [
        "Dropdown with all 7 statuses",
        "Current status pre-selected",
        "Status color indicator",
        "Updates ticket status on save",
        "Follows status flow (any â†’ any allowed)"
      ],
      "references": [
        "src/components/tickets/EditTicketModal.tsx"
      ],
      "description": "Add status selection dropdown with all 7 status options.\n\n**Files to Modify:**\n- `src/components/tickets/EditTicketModal.tsx`\n\n**Acceptance Criteria:**\n- [ ] Dropdown with all 7 statuses\n- [ ] Current status pre-selected\n- [ ] Status color indicator\n- [ ] Updates ticket status on save\n- [ ] Follows status flow (any â†’ any allowed)\n\n**Status Options:**\n```tsx\nconst statuses = [\n  { value: 'backlog', label: 'Backlog', color: 'gray' },\n  { value: 'ready', label: 'Ready', color: 'blue' },\n  { value: 'in_progress', label: 'In Progress', color: 'yellow' },\n  { value: 'review', label: 'Review', color: 'purple' },\n  { value: 'ai_review', label: 'AI Review', color: 'cyan' },\n  { value: 'human_review', label: 'Human Review', color: 'pink' },\n  { value: 'done', label: 'Done', color: 'green' },\n];\n```\n\n**Tests:** Visual inspection",
      "priority": "medium",
      "tags": [
        "modal",
        "form"
      ]
    },
    {
      "id": "394b9cdd-0615-409a-93f2-3d944d9471c6",
      "title": "63 - Create BlockedToggle component",
      "passes": true,
      "overview": "",
      "types": [],
      "designDecisions": [],
      "implementationGuide": [],
      "acceptanceCriteria": [
        "Checkbox/toggle to mark as blocked",
        "Reason input appears when checked",
        "Reason required when blocked",
        "Visual indicator (red/warning)",
        "Saves is_blocked and blocked_reason"
      ],
      "references": [
        "src/components/tickets/BlockedToggle.tsx"
      ],
      "description": "Create toggle for marking ticket as blocked with reason input.\n\n**Files to Create:**\n- `src/components/tickets/BlockedToggle.tsx`\n\n**Acceptance Criteria:**\n- [ ] Checkbox/toggle to mark as blocked\n- [ ] Reason input appears when checked\n- [ ] Reason required when blocked\n- [ ] Visual indicator (red/warning)\n- [ ] Saves is_blocked and blocked_reason\n\n**Layout:**\n```\nâ˜ Mark as Blocked\n\n[When checked:]\nâ˜‘ Mark as Blocked\n  Reason: [_________________________]\n           Waiting on API team\n```\n\n**Tests:** Visual + reason validation",
      "priority": "low",
      "tags": [
        "component",
        "form"
      ]
    },
    {
      "id": "f994d35f-40c5-47d7-880b-66820512ca76",
      "title": "64 - Create SubtaskList component",
      "passes": true,
      "overview": "",
      "types": [],
      "designDecisions": [],
      "implementationGuide": [],
      "acceptanceCriteria": [
        "List of subtask items",
        "Checkbox to mark complete",
        "Text input for subtask title",
        "Delete button per subtask",
        "\"Add subtask\" button",
        "Inline editing",
        "Progress indicator (X of Y complete)",
        "Add subtask",
        "Check/uncheck subtask",
        "Delete subtask",
        "Progress updates"
      ],
      "references": [
        "src/components/tickets/SubtaskList.tsx",
        "src/components/tickets/SubtaskList.test.tsx"
      ],
      "description": "Create subtask list with add/remove/check functionality.\n\n**Files to Create:**\n- `src/components/tickets/SubtaskList.tsx`\n- `src/components/tickets/SubtaskList.test.tsx`\n\n**Acceptance Criteria:**\n- [ ] List of subtask items\n- [ ] Checkbox to mark complete\n- [ ] Text input for subtask title\n- [ ] Delete button per subtask\n- [ ] \"Add subtask\" button\n- [ ] Inline editing\n- [ ] Progress indicator (X of Y complete)\n\n**Layout:**\n```\nSubtasks (2/4 complete)\nâ˜‘ Set up database schema\nâ˜‘ Create API endpoints  \nâ˜ Build UI components\nâ˜ Write tests\n[+ Add subtask]\n```\n\n**Tests:**\n- [ ] Add subtask\n- [ ] Check/uncheck subtask\n- [ ] Delete subtask\n- [ ] Progress updates",
      "priority": "medium",
      "tags": [
        "component",
        "form"
      ]
    },
    {
      "id": "aec1e0fd-9cc5-438c-9043-d8076ba7d873",
      "title": "65 - Add delete ticket with confirmation",
      "passes": true,
      "overview": "",
      "types": [],
      "designDecisions": [],
      "implementationGuide": [],
      "acceptanceCriteria": [
        "Delete button (danger variant) in footer",
        "Confirmation modal before delete",
        "\"Are you sure?\" message with ticket title",
        "Cancel/Delete buttons",
        "Deletes ticket on confirm",
        "Closes both modals on success",
        "Shows success toast",
        "Invalidates queries",
        "Delete ticket",
        "Removed from board"
      ],
      "references": [
        "src/components/tickets/EditTicketModal.tsx"
      ],
      "description": "Add delete functionality with confirmation dialog.\n\n**Files to Modify:**\n- `src/components/tickets/EditTicketModal.tsx`\n\n**Acceptance Criteria:**\n- [ ] Delete button (danger variant) in footer\n- [ ] Confirmation modal before delete\n- [ ] \"Are you sure?\" message with ticket title\n- [ ] Cancel/Delete buttons\n- [ ] Deletes ticket on confirm\n- [ ] Closes both modals on success\n- [ ] Shows success toast\n- [ ] Invalidates queries\n\n**Confirmation Dialog:**\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ âš ï¸ Delete Ticket?                   â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ Are you sure you want to delete     â”‚\nâ”‚ \"Implement user auth\"?              â”‚\nâ”‚                                     â”‚\nâ”‚ This action cannot be undone.       â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚           [Cancel]  [Delete]        â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n**E2E Tests:**\n- [ ] Delete ticket\n- [ ] Removed from board",
      "priority": "medium",
      "tags": [
        "modal",
        "mutation"
      ]
    },
    {
      "id": "ab504b33-c8c4-4163-bb48-f18051a44212",
      "title": "66 - Create LaunchActions section",
      "passes": true,
      "overview": "",
      "types": [],
      "designDecisions": [],
      "implementationGuide": [],
      "acceptanceCriteria": [
        "Section header: \"Start Work With\"",
        "Grid of option cards",
        "Each card has icon, name, description",
        "Recommended option highlighted",
        "Click launches terminal with selected tool",
        "Only shown when ticket is in workable state"
      ],
      "references": [
        "src/components/tickets/LaunchActions.tsx"
      ],
      "description": "Create the \"Start Work With\" section showing AI launch options.\n\n**Files to Create:**\n- `src/components/tickets/LaunchActions.tsx`\n\n**Acceptance Criteria:**\n- [ ] Section header: \"Start Work With\"\n- [ ] Grid of option cards\n- [ ] Each card has icon, name, description\n- [ ] Recommended option highlighted\n- [ ] Click launches terminal with selected tool\n- [ ] Only shown when ticket is in workable state\n\n**Layout:**\n```\nStart Work With\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ â­ Claude       â”‚ â”‚ ğŸ¤– Ralph        â”‚\nâ”‚ Recommended     â”‚ â”‚ Native Mode     â”‚\nâ”‚ Interactive AI  â”‚ â”‚ Autonomous      â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ ğŸ³ Ralph Docker â”‚ â”‚ ğŸ’» OpenCode     â”‚\nâ”‚ Sandboxed       â”‚ â”‚ Alternative     â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n**Tests:** Visual inspection",
      "priority": "high",
      "tags": [
        "component",
        "launch"
      ]
    },
    {
      "id": "284dbb24-db03-4de6-9966-6be6ab56b539",
      "title": "67 - Create SplitButton component",
      "passes": true,
      "overview": "",
      "types": [],
      "designDecisions": [],
      "implementationGuide": [],
      "acceptanceCriteria": [
        "Main button on left (primary action)",
        "Dropdown chevron on right",
        "Click main = execute primary action",
        "Click chevron = show dropdown",
        "Dropdown with alternative actions",
        "Keyboard accessible",
        "Main click fires primary",
        "Dropdown opens",
        "Option click fires handler"
      ],
      "references": [
        "src/components/ui/SplitButton.tsx",
        "src/components/ui/SplitButton.test.tsx"
      ],
      "description": "Create split button with main action and dropdown for alternatives.\n\n**Files to Create:**\n- `src/components/ui/SplitButton.tsx`\n- `src/components/ui/SplitButton.test.tsx`\n\n**Acceptance Criteria:**\n- [ ] Main button on left (primary action)\n- [ ] Dropdown chevron on right\n- [ ] Click main = execute primary action\n- [ ] Click chevron = show dropdown\n- [ ] Dropdown with alternative actions\n- [ ] Keyboard accessible\n\n**Layout:**\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”\nâ”‚ Start with Claude   â”‚ â–¾ â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”˜\n                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n                      â”‚ Ralph Native    â”‚\n                      â”‚ Ralph Docker    â”‚\n                      â”‚ OpenCode        â”‚\n                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n**Tests:**\n- [ ] Main click fires primary\n- [ ] Dropdown opens\n- [ ] Option click fires handler",
      "priority": "medium",
      "tags": [
        "component",
        "ui"
      ]
    },
    {
      "id": "b2f2902c-8c3d-4e5a-b195-11a67e63d89a",
      "title": "68 - Create LaunchOption item components",
      "passes": true,
      "overview": "",
      "types": [],
      "designDecisions": [],
      "implementationGuide": [],
      "acceptanceCriteria": [
        "Claude option (recommended, interactive)",
        "Ralph Native option (autonomous, native)",
        "Ralph Docker option (autonomous, sandboxed)",
        "OpenCode option (alternative)",
        "Hover state with glow",
        "Selected state",
        "Disabled state when unavailable"
      ],
      "references": [
        "src/components/tickets/LaunchActions.tsx"
      ],
      "description": "Create individual launch option cards for each AI tool.\n\n**Files to Modify:**\n- `src/components/tickets/LaunchActions.tsx`\n\n**Acceptance Criteria:**\n- [ ] Claude option (recommended, interactive)\n- [ ] Ralph Native option (autonomous, native)\n- [ ] Ralph Docker option (autonomous, sandboxed)\n- [ ] OpenCode option (alternative)\n- [ ] Hover state with glow\n- [ ] Selected state\n- [ ] Disabled state when unavailable\n\n**Options Config:**\n```tsx\nconst launchOptions = [\n  { id: 'claude', icon: Sparkles, name: 'Claude', desc: 'Interactive AI assistance', recommended: true },\n  { id: 'ralph-native', icon: Bot, name: 'Ralph Native', desc: 'Autonomous agent' },\n  { id: 'ralph-docker', icon: Container, name: 'Ralph Docker', desc: 'Sandboxed agent' },\n  { id: 'opencode', icon: Terminal, name: 'OpenCode', desc: 'Alternative client' },\n];\n```\n\n**Tests:** Visual inspection",
      "priority": "medium",
      "tags": [
        "component",
        "launch"
      ]
    },
    {
      "id": "47defbde-163e-4cd3-a67e-65c06c5a7794",
      "title": "69 - Integrate LaunchActions with terminal API",
      "passes": true,
      "overview": "",
      "types": [],
      "designDecisions": [],
      "implementationGuide": [],
      "acceptanceCriteria": [
        "Uses existing `launchTerminal` server function",
        "Passes ticket ID and launch type",
        "Shows loading state during launch",
        "Error handling with toast",
        "Updates ticket status after launch",
        "Closes modal after successful launch",
        "Click Claude â†’ terminal opens",
        "Click Ralph â†’ Ralph starts"
      ],
      "references": [
        "src/components/tickets/LaunchActions.tsx"
      ],
      "description": "Wire up launch options to existing terminal API server functions.\n\n**Files to Modify:**\n- `src/components/tickets/LaunchActions.tsx`\n\n**Acceptance Criteria:**\n- [ ] Uses existing `launchTerminal` server function\n- [ ] Passes ticket ID and launch type\n- [ ] Shows loading state during launch\n- [ ] Error handling with toast\n- [ ] Updates ticket status after launch\n- [ ] Closes modal after successful launch\n\n**Implementation:**\n```tsx\nconst handleLaunch = async (type: LaunchType) => {\n  try {\n    await launchTerminal({ ticketId: ticket.id, type });\n    toast.success(`Started ${type}`);\n    onClose();\n  } catch (err) {\n    toast.error('Failed to launch terminal');\n  }\n};\n```\n\n**Manual Tests:**\n- [ ] Click Claude â†’ terminal opens\n- [ ] Click Ralph â†’ Ralph starts",
      "priority": "high",
      "tags": [
        "integration",
        "api"
      ]
    },
    {
      "id": "66f4c4da-0924-4111-bf7a-a0b78783f452",
      "title": "70 - Create ActivitySection container",
      "passes": true,
      "overview": "",
      "types": [],
      "designDecisions": [],
      "implementationGuide": [],
      "acceptanceCriteria": [
        "Section header: \"Activity\"",
        "Scrollable comment list",
        "Newest comments at bottom",
        "Comment input at bottom",
        "Empty state: \"No activity yet\"",
        "Uses TanStack Query for comments",
        "Auto-scroll to bottom on new comment"
      ],
      "references": [
        "src/components/tickets/ActivitySection.tsx"
      ],
      "description": "Create the activity/comments section container for tickets.\n\n**Files to Create:**\n- `src/components/tickets/ActivitySection.tsx`\n\n**Acceptance Criteria:**\n- [ ] Section header: \"Activity\"\n- [ ] Scrollable comment list\n- [ ] Newest comments at bottom\n- [ ] Comment input at bottom\n- [ ] Empty state: \"No activity yet\"\n- [ ] Uses TanStack Query for comments\n- [ ] Auto-scroll to bottom on new comment\n\n**Layout:**\n```\nActivity\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ [Comment 1]                        â”‚\nâ”‚ [Comment 2]                        â”‚\nâ”‚ [Comment 3]                        â”‚  <- Scrollable\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ [Add a comment...          ] [Send]â”‚  <- Fixed at bottom\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n**Tests:** Visual inspection",
      "priority": "medium",
      "tags": [
        "component",
        "activity"
      ]
    },
    {
      "id": "fded1cd5-0fb0-4caf-9bc7-bc4660bf937d",
      "title": "71 - Create Comment component",
      "passes": false,
      "overview": "",
      "types": [],
      "designDecisions": [],
      "implementationGuide": [],
      "acceptanceCriteria": [
        "4 comment types with distinct colors:",
        "Avatar on left",
        "Author name and timestamp",
        "Markdown-rendered content",
        "Expandable for long content"
      ],
      "references": [
        "src/components/tickets/Comment.tsx"
      ],
      "description": "Create individual comment component with type-specific styling.\n\n**Files to Create:**\n- `src/components/tickets/Comment.tsx`\n\n**Acceptance Criteria:**\n- [ ] 4 comment types with distinct colors:\n  - progress: teal left border\n  - work_summary: purple left border\n  - test_report: green left border\n  - comment: default gray border\n- [ ] Avatar on left\n- [ ] Author name and timestamp\n- [ ] Markdown-rendered content\n- [ ] Expandable for long content\n\n**Layout:**\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ [ğŸ‘¤] Claude Â· 2 hours ago          â”‚\nâ”‚ â”‚ Work Summary                     â”‚  <- Purple border\nâ”‚ â”‚ - Implemented auth endpoints     â”‚\nâ”‚ â”‚ - Added validation               â”‚\nâ”‚ â”‚ - Updated tests                  â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n**Tests:** Visual - all 4 types",
      "priority": "medium",
      "tags": [
        "component",
        "activity"
      ]
    },
    {
      "id": "e905a17b-df1e-4c97-a78a-bd693f7635e2",
      "title": "72 - Create CommentAvatar component",
      "passes": false,
      "overview": "",
      "types": [],
      "designDecisions": [],
      "implementationGuide": [],
      "acceptanceCriteria": [
        "Gradient backgrounds by author type:",
        "First letter or icon",
        "Consistent size (32px)",
        "Rounded full"
      ],
      "references": [
        "src/components/tickets/CommentAvatar.tsx"
      ],
      "description": "Create avatar component with author-specific gradients.\n\n**Files to Create:**\n- `src/components/tickets/CommentAvatar.tsx`\n\n**Acceptance Criteria:**\n- [ ] Gradient backgrounds by author type:\n  - claude: purple gradient\n  - ralph: cyan gradient\n  - user: orange gradient (from theme)\n  - opencode: green gradient\n- [ ] First letter or icon\n- [ ] Consistent size (32px)\n- [ ] Rounded full\n\n**Author Styles:**\n```tsx\nconst authorStyles = {\n  claude: { gradient: 'from-purple-500 to-violet-500', icon: 'âœ¨' },\n  ralph: { gradient: 'from-cyan-500 to-blue-500', icon: 'ğŸ¤–' },\n  user: { gradient: 'from-orange-500 to-amber-500', letter: true },\n  opencode: { gradient: 'from-green-500 to-emerald-500', icon: 'ğŸ’»' },\n};\n```\n\n**Tests:** Visual inspection",
      "priority": "low",
      "tags": [
        "component",
        "activity"
      ]
    },
    {
      "id": "bdf7c541-e594-4692-800d-49b7d1736890",
      "title": "73 - Create CommentInput component",
      "passes": false,
      "overview": "",
      "types": [],
      "designDecisions": [],
      "implementationGuide": [],
      "acceptanceCriteria": [
        "Textarea for comment content",
        "Send button (icon or text)",
        "Ctrl+Enter to submit",
        "Disabled state while submitting",
        "Clear after successful submit",
        "Uses existing `addTicketComment` API",
        "Type and submit",
        "Comment appears in list"
      ],
      "references": [
        "src/components/tickets/CommentInput.tsx",
        "src/components/tickets/CommentInput.test.tsx"
      ],
      "description": "Create comment input with submit functionality.\n\n**Files to Create:**\n- `src/components/tickets/CommentInput.tsx`\n- `src/components/tickets/CommentInput.test.tsx`\n\n**Acceptance Criteria:**\n- [ ] Textarea for comment content\n- [ ] Send button (icon or text)\n- [ ] Ctrl+Enter to submit\n- [ ] Disabled state while submitting\n- [ ] Clear after successful submit\n- [ ] Uses existing `addTicketComment` API\n\n**Implementation:**\n```tsx\nconst addCommentMutation = useMutation({\n  mutationFn: addTicketComment,\n  onSuccess: () => {\n    queryClient.invalidateQueries({ queryKey: ['comments', ticketId] });\n    setContent('');\n  },\n});\n```\n\n**Tests:**\n- [ ] Type and submit\n- [ ] Comment appears in list",
      "priority": "medium",
      "tags": [
        "component",
        "form"
      ]
    },
    {
      "id": "36d66de5-42db-4822-8b5b-62d26f29c5ad",
      "title": "74 - Add code block rendering to comments",
      "passes": false,
      "overview": "",
      "types": [],
      "designDecisions": [],
      "implementationGuide": [],
      "acceptanceCriteria": [
        "Detect markdown code blocks in content",
        "Apply syntax highlighting (basic)",
        "Dark theme code blocks",
        "Copy button on code blocks",
        "Language indicator",
        "Horizontal scroll for long lines"
      ],
      "references": [
        "src/components/tickets/Comment.tsx"
      ],
      "description": "Add syntax highlighting for code blocks in work summaries.\n\n**Files to Modify:**\n- `src/components/tickets/Comment.tsx`\n\n**Acceptance Criteria:**\n- [ ] Detect markdown code blocks in content\n- [ ] Apply syntax highlighting (basic)\n- [ ] Dark theme code blocks\n- [ ] Copy button on code blocks\n- [ ] Language indicator\n- [ ] Horizontal scroll for long lines\n\n**Implementation:**\n```tsx\n// Use a lightweight highlighter\nimport { highlight } from 'prismjs';\n\n// Or simpler: just style code blocks without full highlighting\n<pre className=\"bg-bg-secondary rounded p-3 overflow-x-auto\">\n  <code>{codeContent}</code>\n</pre>\n```\n\n**Tests:** Visual - paste comment with code block",
      "priority": "low",
      "tags": [
        "component",
        "markdown"
      ]
    }
  ],
  "projectContext": {
    "techStack": [
      "Framework: TanStack Start (React 19 + Vite + Nitro)",
      "Database: SQLite with better-sqlite3, Drizzle ORM",
      "Styling: Tailwind CSS v4",
      "State: TanStack Query for server state",
      "Drag & Drop: @dnd-kit"
    ],
    "dosDonts": [
      {
        "category": "Database Queries",
        "dos": [
          "Use Drizzle ORM: `db.select().from(tickets)`",
          "Use typed schema imports: `import { tickets } from \"../lib/schema\"`",
          "Use `eq()`, `and()`, `sql` from drizzle-orm for conditions",
          "Use transactions for multi-table operations: `db.transaction(() => {...})`",
          "Use `.get()` for single row, `.all()` for multiple"
        ],
        "donts": [
          "Raw SQL strings: `db.run(\"SELECT * FROM tickets\")`",
          "String-based table names",
          "String concatenation for WHERE clauses",
          "Multiple independent queries that should be atomic",
          "Assume query returns what you expect without checking"
        ]
      },
      {
        "category": "React & TanStack Query",
        "dos": [
          "Use `useQuery` with `queryKeys` for data fetching",
          "Use `useMutation` with `onSuccess` for state changes",
          "Invalidate queries after mutations: `queryClient.invalidateQueries({ queryKey: queryKeys.tickets })`",
          "Use centralized `queryKeys` object from `src/lib/hooks.ts`",
          "Create custom hooks in `src/lib/hooks.ts` for reusable query logic"
        ],
        "donts": [
          "`useState` + `useEffect` for fetched data",
          "Direct API calls without proper cache invalidation",
          "Manual cache manipulation or refetch after every change",
          "Hardcoded query key strings throughout components",
          "Duplicate query setup in multiple components"
        ]
      },
      {
        "category": "Server Functions",
        "dos": [
          "Use `createServerFn({ method: \"GET\" })` for reads, `\"POST\"` for writes",
          "Use `.inputValidator()` for type-safe input handling",
          "Return typed data directly: `return db.select().from(tickets).all()`",
          "Use `ensureExists()` for required lookups: `ensureExists(project, \"Project\")`",
          "Import from `@tanstack/react-start` (not `@tanstack/react-start/server`)"
        ],
        "donts": [
          "Mix GET/POST inconsistently",
          "Access raw input without validation",
          "Wrap in unnecessary response objects",
          "Return null and let caller handle missing data",
          "Wrong import path"
        ]
      },
      {
        "category": "MCP Tool Implementation",
        "dos": [
          "Use Zod schemas for input validation: `{ ticketId: z.string() }`",
          "Return structured `{ content: [{ type: \"text\", text: ... }] }` format",
          "Set `isError: true` for error responses",
          "Use `log.info()` / `log.error()` from `../lib/logging.js`",
          "Include helpful error messages: `\"Project not found. Use list_projects to see available.\"`"
        ],
        "donts": [
          "Trust input without validation",
          "Return plain strings",
          "Return error text without the error flag",
          "`console.log` in MCP server code",
          "Generic \"Not found\" errors"
        ]
      },
      {
        "category": "Testing Patterns (Kent C. Dodds)",
        "dos": [
          "Test user behavior: what users see, click, and experience",
          "Integration tests for workflows: test components together",
          "Real database fixtures with actual schema",
          "Tests that fail when user-facing behavior breaks",
          "Ask: \"Does this test catch bugs users would encounter?\""
        ],
        "donts": [
          "Test implementation details, internal state, or private methods",
          "Unit tests for every function",
          "Excessive mocking of internals",
          "Tests that break on refactoring internals",
          "Chase 100% code coverage as a goal"
        ]
      }
    ],
    "verificationSteps": [
      "Run `pnpm type-check` - must pass with no errors",
      "Run `pnpm lint` - must pass with no errors",
      "Run `pnpm test` - all tests must pass",
      "Added tests for new functionality (ONLY tests that verify real user behavior - see Testing Philosophy above)",
      "Used typed error classes (not generic `Error`)",
      "Used Drizzle ORM (not raw SQL) - see DO/DON'T table above",
      "Followed existing patterns from DO/DON'T tables",
      "No hardcoded values that should be configurable",
      "Existing tests still pass",
      "No regressions in related functionality",
      "Updated tests if behavior changed",
      "Did not break backward compatibility (unless explicitly requested)",
      "Manually verified in browser at `localhost:4242`",
      "Checked responsive layout",
      "Verified TanStack Query invalidates and updates correctly",
      "Accessibility: keyboard navigation works, proper ARIA labels",
      "Migration file created via `pnpm db:generate`",
      "Migration tested with `pnpm db:migrate`",
      "Backup tested if schema changed (use `pnpm brain-dump backup` then test restore)",
      "Updated `src/lib/schema.ts` with proper types and constraints",
      "Tested tool via Claude Code integration",
      "Verified error responses are informative (see DO/DON'T table)",
      "Updated tool documentation if interface changed",
      "Added Zod schema for input validation",
      "All acceptance criteria from ticket met",
      "Work summary added via `add_ticket_comment` (for Ralph sessions)",
      "Session completed with appropriate outcome (for Ralph sessions)",
      "Committed with proper message format: `feat(<ticket-id>): <description>`"
    ]
  },
  "generatedAt": "2026-01-20T23:16:44.087Z",
  "epicTitle": "UI v2 Sprint 4: Ticket Flows",
  "epicDescription": "Build ticket creation, editing, and management flows including quick-add inline creation, full ticket modal, subtasks, comments, and file attachments UI."
}

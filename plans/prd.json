{
  "projectName": "Brain Dump",
  "projectPath": "/Users/salman.rana/code/brain-dump",
  "testingRequirements": [
    "Tests must validate user-facing behavior, not implementation details",
    "Focus on what users actually do - integration tests over unit tests",
    "Don't mock excessively - test real behavior where possible",
    "Coverage metrics are meaningless - user flow coverage is everything"
  ],
  "userStories": [
    {
      "id": "75b24d41-d6c7-4e68-b16a-332dbc8e662e",
      "title": "01 - Create feature/ui-v2 branch",
      "passes": true,
      "overview": "",
      "types": [],
      "designDecisions": [],
      "implementationGuide": [],
      "acceptanceCriteria": [
        "Branch `feature/ui-v2` created from main",
        "Branch pushed to remote"
      ],
      "references": [],
      "description": "Create the `feature/ui-v2` branch from main for parallel UI development.\n\n**Acceptance Criteria:**\n- [ ] Branch `feature/ui-v2` created from main\n- [ ] Branch pushed to remote\n\n**Commands:**\n```bash\ngit checkout main\ngit pull\ngit checkout -b feature/ui-v2\ngit push -u origin feature/ui-v2\n```",
      "priority": "high",
      "tags": [
        "setup",
        "git"
      ]
    },
    {
      "id": "1544e96f-006c-47d2-b59c-7b96e54476a4",
      "title": "02 - Add dev:v2 script to package.json",
      "passes": false,
      "overview": "",
      "types": [],
      "designDecisions": [],
      "implementationGuide": [],
      "acceptanceCriteria": [
        "`dev:v2` script added to package.json",
        "Runs on port 4243",
        "Can run alongside `dev` script"
      ],
      "references": [],
      "description": "Add `dev:v2` npm script to run the new UI on port 4243 while the old UI runs on 4242.\n\n**Acceptance Criteria:**\n- [ ] `dev:v2` script added to package.json\n- [ ] Runs on port 4243\n- [ ] Can run alongside `dev` script\n\n**Changes:**\n```json\n{\n  \"scripts\": {\n    \"dev\": \"vinxi dev --port 4242\",\n    \"dev:v2\": \"vinxi dev --port 4243\"\n  }\n}\n```\n\n**Validation:**\nRun `pnpm dev` and `pnpm dev:v2` in separate terminals - both should load without conflict.",
      "priority": "high",
      "tags": [
        "setup",
        "config"
      ]
    },
    {
      "id": "f42887e8-2c2e-43a8-96d8-277a02822ff0",
      "title": "03 - Create src/components-v2/ directory structure",
      "passes": false,
      "overview": "",
      "types": [],
      "designDecisions": [],
      "implementationGuide": [],
      "acceptanceCriteria": [
        "`src/components-v2/` directory created with subdirs",
        "Empty index.ts exports in each directory",
        ".gitkeep files where needed"
      ],
      "references": [
        "src/components-v2/",
        "src/components/"
      ],
      "description": "Create the temporary component directory structure for the new UI during development.\n\n**Acceptance Criteria:**\n- [ ] `src/components-v2/` directory created with subdirs\n- [ ] Empty index.ts exports in each directory\n- [ ] .gitkeep files where needed\n\n**Directory Structure:**\n```\nsrc/components-v2/\n├── ui/\n├── navigation/\n├── dashboard/\n├── board/\n├── tickets/\n├── projects/\n├── epics/\n├── inception/\n└── settings/\n```\n\n**Note:** This structure will eventually replace `src/components/` after merge.",
      "priority": "medium",
      "tags": [
        "setup",
        "structure"
      ]
    },
    {
      "id": "bf4d5e12-1235-4754-b76c-b73ccaa94d7d",
      "title": "04 - Verify parallel UI development works",
      "passes": false,
      "overview": "",
      "types": [],
      "designDecisions": [],
      "implementationGuide": [],
      "acceptanceCriteria": [
        "Old UI loads at http://localhost:4242",
        "New UI loads at http://localhost:4243",
        "Both share the same SQLite database",
        "Changes in one UI reflect in the other after refresh",
        "No port conflicts or file locking issues"
      ],
      "references": [],
      "description": "Test that both UIs can run simultaneously on different ports.\n\n**Acceptance Criteria:**\n- [ ] Old UI loads at http://localhost:4242\n- [ ] New UI loads at http://localhost:4243\n- [ ] Both share the same SQLite database\n- [ ] Changes in one UI reflect in the other after refresh\n- [ ] No port conflicts or file locking issues\n\n**Test Steps:**\n1. Terminal 1: `git checkout main && pnpm dev`\n2. Terminal 2: `git checkout feature/ui-v2 && pnpm dev:v2`\n3. Create a ticket in old UI\n4. Verify it appears in new UI (after refresh)\n5. Vice versa",
      "priority": "high",
      "tags": [
        "setup",
        "testing"
      ]
    },
    {
      "id": "5a06e93c-36d1-427d-8080-42ea0e6bf4ca",
      "title": "05 - Document parallel development workflow",
      "passes": false,
      "overview": "",
      "types": [],
      "designDecisions": [],
      "implementationGuide": [],
      "acceptanceCriteria": [
        "README section added to `feature/ui-v2` branch",
        "Explains branch strategy",
        "Explains port assignments",
        "Explains what's shared vs rebuilt",
        "Includes common commands"
      ],
      "references": [],
      "description": "Create documentation for the parallel development workflow so developers know how to work on both UIs.\n\n**Acceptance Criteria:**\n- [ ] README section added to `feature/ui-v2` branch\n- [ ] Explains branch strategy\n- [ ] Explains port assignments\n- [ ] Explains what's shared vs rebuilt\n- [ ] Includes common commands\n\n**Content to Document:**\n- Branch strategy (main = old UI, feature/ui-v2 = new UI)\n- Port assignments (4242 vs 4243)\n- Shared backend files (src/api/, src/lib/schema.ts, mcp-server/)\n- New frontend files (src/components-v2/, src/routes-v2/)\n- Development workflow commands\n- Merge checklist reference",
      "priority": "medium",
      "tags": [
        "setup",
        "docs"
      ]
    }
  ],
  "projectContext": {
    "techStack": [
      "Framework: TanStack Start (React 19 + Vite + Nitro)",
      "Database: SQLite with better-sqlite3, Drizzle ORM",
      "Styling: Tailwind CSS v4",
      "State: TanStack Query for server state",
      "Drag & Drop: @dnd-kit"
    ],
    "dosDonts": [
      {
        "category": "Database Queries",
        "dos": [
          "Use Drizzle ORM: `db.select().from(tickets)`",
          "Use typed schema imports: `import { tickets } from \"../lib/schema\"`",
          "Use `eq()`, `and()`, `sql` from drizzle-orm for conditions",
          "Use transactions for multi-table operations: `db.transaction(() => {...})`",
          "Use `.get()` for single row, `.all()` for multiple"
        ],
        "donts": [
          "Raw SQL strings: `db.run(\"SELECT * FROM tickets\")`",
          "String-based table names",
          "String concatenation for WHERE clauses",
          "Multiple independent queries that should be atomic",
          "Assume query returns what you expect without checking"
        ]
      },
      {
        "category": "React & TanStack Query",
        "dos": [
          "Use `useQuery` with `queryKeys` for data fetching",
          "Use `useMutation` with `onSuccess` for state changes",
          "Invalidate queries after mutations: `queryClient.invalidateQueries({ queryKey: queryKeys.tickets })`",
          "Use centralized `queryKeys` object from `src/lib/hooks.ts`",
          "Create custom hooks in `src/lib/hooks.ts` for reusable query logic"
        ],
        "donts": [
          "`useState` + `useEffect` for fetched data",
          "Direct API calls without proper cache invalidation",
          "Manual cache manipulation or refetch after every change",
          "Hardcoded query key strings throughout components",
          "Duplicate query setup in multiple components"
        ]
      },
      {
        "category": "Server Functions",
        "dos": [
          "Use `createServerFn({ method: \"GET\" })` for reads, `\"POST\"` for writes",
          "Use `.inputValidator()` for type-safe input handling",
          "Return typed data directly: `return db.select().from(tickets).all()`",
          "Use `ensureExists()` for required lookups: `ensureExists(project, \"Project\")`",
          "Import from `@tanstack/react-start` (not `@tanstack/react-start/server`)"
        ],
        "donts": [
          "Mix GET/POST inconsistently",
          "Access raw input without validation",
          "Wrap in unnecessary response objects",
          "Return null and let caller handle missing data",
          "Wrong import path"
        ]
      },
      {
        "category": "MCP Tool Implementation",
        "dos": [
          "Use Zod schemas for input validation: `{ ticketId: z.string() }`",
          "Return structured `{ content: [{ type: \"text\", text: ... }] }` format",
          "Set `isError: true` for error responses",
          "Use `log.info()` / `log.error()` from `../lib/logging.js`",
          "Include helpful error messages: `\"Project not found. Use list_projects to see available.\"`"
        ],
        "donts": [
          "Trust input without validation",
          "Return plain strings",
          "Return error text without the error flag",
          "`console.log` in MCP server code",
          "Generic \"Not found\" errors"
        ]
      },
      {
        "category": "Testing Patterns (Kent C. Dodds)",
        "dos": [
          "Test user behavior: what users see, click, and experience",
          "Integration tests for workflows: test components together",
          "Real database fixtures with actual schema",
          "Tests that fail when user-facing behavior breaks",
          "Ask: \"Does this test catch bugs users would encounter?\""
        ],
        "donts": [
          "Test implementation details, internal state, or private methods",
          "Unit tests for every function",
          "Excessive mocking of internals",
          "Tests that break on refactoring internals",
          "Chase 100% code coverage as a goal"
        ]
      }
    ],
    "verificationSteps": [
      "Run `pnpm type-check` - must pass with no errors",
      "Run `pnpm lint` - must pass with no errors",
      "Run `pnpm test` - all tests must pass",
      "Added tests for new functionality (following Kent C. Dodds testing philosophy)",
      "Used typed error classes (not generic `Error`)",
      "Used Drizzle ORM (not raw SQL) - see DO/DON'T table above",
      "Followed existing patterns from DO/DON'T tables",
      "No hardcoded values that should be configurable",
      "Existing tests still pass",
      "No regressions in related functionality",
      "Updated tests if behavior changed",
      "Did not break backward compatibility (unless explicitly requested)",
      "Manually verified in browser at `localhost:4242`",
      "Checked responsive layout",
      "Verified TanStack Query invalidates and updates correctly",
      "Accessibility: keyboard navigation works, proper ARIA labels",
      "Migration file created via `pnpm db:generate`",
      "Migration tested with `pnpm db:migrate`",
      "Backup tested if schema changed (use `pnpm brain-dump backup` then test restore)",
      "Updated `src/lib/schema.ts` with proper types and constraints",
      "Tested tool via Claude Code integration",
      "Verified error responses are informative (see DO/DON'T table)",
      "Updated tool documentation if interface changed",
      "Added Zod schema for input validation",
      "All acceptance criteria from ticket met",
      "Work summary added via `add_ticket_comment` (for Ralph sessions)",
      "Session completed with appropriate outcome (for Ralph sessions)",
      "Committed with proper message format: `feat(<ticket-id>): <description>`"
    ]
  },
  "generatedAt": "2026-01-19T20:19:33.307Z",
  "epicTitle": "UI v2 Sprint 0: Setup & Parallel Development",
  "epicDescription": "**GREENFIELD REBUILD** - Start fresh on `feature/ui-v2` branch.\n\n## Branch Strategy\n- Create NEW `feature/ui-v2` branch from main\n- This is a complete UI rebuild, NOT a migration\n- Old UI code stays on main (port 4242) for reference\n- New UI runs on port 4243 during development\n\n## What's Shared (Unchanged)\n- `src/api/*` - All server functions\n- `src/lib/schema.ts` - Database schema\n- `src/lib/db.ts` - Database connection\n- `mcp-server/*` - MCP integration\n- `cli/*` - CLI tool\n\n## What's Rebuilt (New Files)\n- `src/components/*` - All new components\n- `src/routes/*` - New route structure  \n- `src/styles.css` - New with CSS variables\n- `src/lib/theme.ts` - New theme system\n\n## Parallel Development\nBoth UIs can run simultaneously:\n- `pnpm dev` → port 4242 (old UI on main)\n- `pnpm dev:v2` → port 4243 (new UI on feature/ui-v2)\n\n## Important\n- Do NOT try to migrate existing components\n- Start fresh with the Neon Productivity design\n- Reference old code for API patterns only"
}
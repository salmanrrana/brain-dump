{
  "projectName": "Brain Dump",
  "projectPath": "/home/xtra/code/personal_projects/brain-dump",
  "testingRequirements": [
    "Tests must validate user-facing behavior, not implementation details",
    "Focus on what users actually do - integration tests over unit tests",
    "Don't mock excessively - test real behavior where possible",
    "Coverage metrics are meaningless - user flow coverage is everything"
  ],
  "userStories": [
    {
      "id": "9200b1ca-0027-4131-a95b-5519e79e55c0",
      "title": "Overview: Projects Home Page — Full Plan & Coordination",
      "passes": false,
      "overview": "**Epic:** Projects Home Page\n**Branch/PR:** All tickets in this epic share a single branch and PR. Use `workflow` `start-epic` to create the shared branch before starting work on any ticket.\n---\nCurrently Brain Dump drops users directly onto a kanban board showing all tickets — which gets overwhelming as projects grow. This change introduces a clean **Projects home page** as the landing page, with drill-down into epics, providing a structured entry: **Projects → Epics → Filtered Kanban Board**.",
      "types": [],
      "designDecisions": [],
      "implementationGuide": [],
      "acceptanceCriteria": [
        "Implement as described",
        "Verify functionality works as expected"
      ],
      "references": [
        "src/routes/board.tsx",
        "src/routes/index.tsx",
        "src/routes/dashboard.tsx",
        "src/routes/ticket.$id.tsx",
        "src/components/AppLayout.tsx",
        "src/lib/hooks/projects.ts",
        "src/components/projects/ProjectCard.tsx",
        "src/routes/projects.$projectId.tsx",
        "src/components/navigation/EpicListItem.tsx",
        "src/components/navigation/IconSidebar.tsx",
        "src/components/layout/AppHeader.tsx",
        "src/components/navigation/EpicDrillInView.tsx",
        "src/lib/filter-hooks.ts"
      ],
      "description": "# Overview: Projects Home Page\n\n**Epic:** Projects Home Page\n**Branch/PR:** All tickets in this epic share a single branch and PR. Use `workflow` `start-epic` to create the shared branch before starting work on any ticket.\n\n---\n\n# Plan: Projects Home Page\n\n## Context\n\nCurrently Brain Dump drops users directly onto a kanban board showing all tickets — which gets overwhelming as projects grow. This change introduces a clean **Projects home page** as the landing page, with drill-down into epics, providing a structured entry: **Projects → Epics → Filtered Kanban Board**.\n\n## Route Changes\n\n| Before | After |\n|--------|-------|\n| `/` → Kanban board | `/` → Projects home page |\n| _(none)_ | `/board` → Kanban board (moved from `/`) |\n| _(none)_ | `/projects/$projectId` → Project detail (epic list) |\n\nThe sidebar \"Projects\" icon (shortcut 3) **keeps** its current behavior (opens slide-out ProjectsPanel). The \"Board\" icon (shortcut 2) updates to point to `/board`. \n\n## Steps\n\n### 1. Move kanban board from `/` to `/board`\n\n- **Create** `src/routes/board.tsx` — copy entire contents of current `src/routes/index.tsx`, change route path to `/board`\n- **Update** `src/routes/index.tsx` — replace with new Projects home (step 3)\n\n### 2. Update internal navigations from `/` to `/board`\n\nThese files navigate to `/` expecting the board — update to `/board`:\n\n| File | Line | Change |\n|------|------|--------|\n| `src/routes/dashboard.tsx` | 112 | `navigate({ to: \"/board\" })` |\n| `src/routes/ticket.$id.tsx` | 60, 330 | `router.navigate({ to: \"/board\" })` |\n| `src/components/AppLayout.tsx` | 367 | `navigate({ to: \"/board\" })` |\n\n### 3. Create Projects home page (`/`)\n\n**New file:** `src/routes/index.tsx`\n\n- Uses `useProjectsWithAIActivity()` hook (already exists in `src/lib/hooks/projects.ts`)\n- Renders a responsive grid of project cards\n- Each card shows: project name, path (truncated), epic count, ticket stats, AI activity glow\n- Click a card → navigate to `/projects/$projectId`\n- Empty state with \"Add Project\" CTA\n- Header with \"Projects\" title + \"New Project\" button (reuse existing `ProjectModal`)\n\n**New file:** `src/components/projects/ProjectCard.tsx`\n\n- Card component for the grid\n- Props: project data (ProjectWithAIActivity), onClick, onEdit\n- Shows color accent from `project.color`\n- AI glow animation when `hasActiveAI` (reuse existing keyframes from ProjectsPanel)\n- \"View All Tickets\" secondary action → navigate to `/board?project=X`\n\n### 4. Create Project detail page (`/projects/$projectId`)\n\n**New file:** `src/routes/projects.$projectId.tsx`\n\n- Fetches project from `useProjects()` by matching `projectId` param\n- Shows project header (name, path, color) with back navigation to `/`\n- Lists epics using existing `EpicListItem` component from `src/components/navigation/EpicListItem.tsx`\n- Click epic → navigate to `/board?project=X&epic=Y` (uses existing URL filter system)\n- \"View All Tickets\" button → navigate to `/board?project=X`\n- \"Add Epic\" button (reuse existing epic creation modal)\n- Empty state: \"No epics yet — create your first epic to organize your tickets\"\n- Epic ticket counts via `useTickets` or a lightweight count query\n\n### 5. Update sidebar navigation\n\n**Modify** `src/components/navigation/IconSidebar.tsx`:\n- Change Board nav item path from `\"/\"` to `\"/board\"`\n- Add new \"Home\" nav item at position 0 with path `\"/\"`  and a Home icon\n- Update shortcut keys: Home=1, Dashboard=2, Board=3, Projects=4(panel), Settings=5\n\n**OR** simpler approach — keep 4 items, just update Board path:\n- Dashboard (1) → `/dashboard`\n- Board (2) → `/board`\n- Projects (3) → slide-out panel (unchanged)\n- Settings (4) → modal (unchanged)\n\nUsers reach the home page by clicking the app logo/brand or navigating to `/` directly. The sidebar doesn't need a dedicated home item if the header has one.\n\n### 6. Add home navigation affordance\n\nAdd a clickable logo/brand element in the header (`src/components/layout/AppHeader.tsx`) that navigates to `/` (projects home). This gives users a consistent way back to the projects overview.\n\n## Key Files\n\n| File | Action | Purpose |\n|------|--------|---------|\n| `src/routes/board.tsx` | Create | New board route (moved from index) |\n| `src/routes/index.tsx` | Rewrite | New projects home page |\n| `src/routes/projects.$projectId.tsx` | Create | Project detail with epic list |\n| `src/components/projects/ProjectCard.tsx` | Create | Project card for grid |\n| `src/components/navigation/IconSidebar.tsx` | Modify | Update Board path to `/board` |\n| `src/components/layout/AppHeader.tsx` | Modify | Add home link on logo/brand |\n| `src/routes/dashboard.tsx` | Modify | Update nav to `/board` |\n| `src/routes/ticket.$id.tsx` | Modify | Update nav to `/board` |\n| `src/components/AppLayout.tsx` | Modify | Update nav to `/board` |\n\n## Reusable Existing Code\n\n- **`useProjectsWithAIActivity()`** — `src/lib/hooks/projects.ts` — projects + AI glow data\n- **`useProjects()`** — `src/lib/hooks/projects.ts` — projects with epics\n- **`EpicListItem`** — `src/components/navigation/EpicListItem.tsx` — compact epic row with actions\n- **`EpicDrillInView`** — `src/components/navigation/EpicDrillInView.tsx` — epic list with search/back nav (reference for layout)\n- **`ProjectModal`** — existing modal for creating/editing projects\n- **`EpicModal`** — existing modal for creating/editing epics\n- **URL filter system** — `useFiltersWithUrl()` in `src/lib/filter-hooks.ts` — board already reads `?project=X&epic=Y`\n- **AI glow keyframes** — from ProjectsPanel CSS\n\n## Verification\n\n1. `pnpm type-check` — no type errors\n2. `pnpm lint` — no lint errors\n3. `pnpm test` — existing tests pass\n4. Manual testing:\n   - Navigate to `/` → see project cards\n   - Click project → see epic list at `/projects/:id`\n   - Click epic → board opens at `/board?project=X&epic=Y` with filtered tickets\n   - Click \"View All Tickets\" → board opens at `/board?project=X`\n   - Sidebar Board icon → goes to `/board`\n   - Sidebar Projects icon → opens slide-out panel (unchanged)\n   - Dashboard \"back\" nav → goes to `/board`\n   - Browser back/forward works across all transitions\n   - Empty state renders when no projects exist\n   - Empty epic state renders when project has no epics",
      "priority": "high",
      "tags": [
        "overview",
        "planning"
      ]
    },
    {
      "id": "73fab3e7-a1a9-464d-a96a-323778157cca",
      "title": "Move kanban board from `/` to `/board`",
      "passes": false,
      "overview": "",
      "types": [],
      "designDecisions": [],
      "implementationGuide": [],
      "acceptanceCriteria": [
        "`src/routes/board.tsx` exists and renders the kanban board at `/board`",
        "Navigating to `/board` shows the full kanban board with all existing functionality",
        "`pnpm type-check` passes",
        "`pnpm lint` passes"
      ],
      "references": [
        "src/routes/board.tsx",
        "src/routes/index.tsx"
      ],
      "description": "## Shared Branch/PR\n\nAll tickets in epic \"Projects Home Page\" share a single branch and PR. Use `workflow` `start-epic` on the epic to create the shared branch before starting work.\n\n## What\n\nMove the existing kanban board route from `/` to `/board` so `/` can become the new Projects home page.\n\n## Steps\n\n1. **Create** `src/routes/board.tsx` — copy entire contents of current `src/routes/index.tsx`, change route path to `/board`\n2. Leave `src/routes/index.tsx` as a stub (will be replaced by the Projects home page ticket)\n\n## Acceptance Criteria\n\n- [ ] `src/routes/board.tsx` exists and renders the kanban board at `/board`\n- [ ] Navigating to `/board` shows the full kanban board with all existing functionality\n- [ ] `pnpm type-check` passes\n- [ ] `pnpm lint` passes",
      "priority": "high",
      "tags": [
        "routing",
        "refactor"
      ]
    },
    {
      "id": "511591a8-de3a-48f4-957c-6e35bd4fb552",
      "title": "Update internal navigations from `/` to `/board`",
      "passes": false,
      "overview": "",
      "types": [],
      "designDecisions": [],
      "implementationGuide": [],
      "acceptanceCriteria": [
        "All navigations that previously went to `/` (expecting the board) now go to `/board`",
        "Dashboard \"back\" navigation goes to `/board`",
        "Ticket detail \"back to board\" goes to `/board`",
        "AppLayout fallback navigation goes to `/board`",
        "`pnpm type-check` passes",
        "`pnpm lint` passes"
      ],
      "references": [
        "src/routes/dashboard.tsx",
        "src/routes/ticket.$id.tsx",
        "src/components/AppLayout.tsx"
      ],
      "description": "## Shared Branch/PR\n\nAll tickets in epic \"Projects Home Page\" share a single branch and PR. Use `workflow` `start-epic` on the epic to create the shared branch before starting work.\n\n## What\n\nSeveral files navigate to `/` expecting the kanban board. Update all of them to point to `/board`.\n\n## Files to Update\n\n| File | Line | Change |\n|------|------|--------|\n| `src/routes/dashboard.tsx` | ~112 | `navigate({ to: \"/board\" })` |\n| `src/routes/ticket.$id.tsx` | ~60, ~330 | `router.navigate({ to: \"/board\" })` |\n| `src/components/AppLayout.tsx` | ~367 | `navigate({ to: \"/board\" })` |\n\n## Acceptance Criteria\n\n- [ ] All navigations that previously went to `/` (expecting the board) now go to `/board`\n- [ ] Dashboard \"back\" navigation goes to `/board`\n- [ ] Ticket detail \"back to board\" goes to `/board`\n- [ ] AppLayout fallback navigation goes to `/board`\n- [ ] `pnpm type-check` passes\n- [ ] `pnpm lint` passes",
      "priority": "high",
      "tags": [
        "routing",
        "refactor"
      ]
    },
    {
      "id": "dca04300-404b-438b-848f-2eabfcdc0991",
      "title": "Create Projects home page (`/`)",
      "passes": false,
      "overview": "",
      "types": [],
      "designDecisions": [],
      "implementationGuide": [],
      "acceptanceCriteria": [
        "`/` renders a responsive grid of project cards",
        "Each card shows project name, path, epic count, ticket stats",
        "AI activity glow appears on cards with active sessions",
        "Clicking a card navigates to `/projects/$projectId`",
        "Empty state renders with \"Add Project\" CTA when no projects exist",
        "\"New Project\" button opens ProjectModal",
        "`pnpm type-check` passes",
        "`pnpm lint` passes"
      ],
      "references": [
        "src/routes/index.tsx",
        "src/lib/hooks/projects.ts",
        "src/components/projects/ProjectCard.tsx"
      ],
      "description": "## Shared Branch/PR\n\nAll tickets in epic \"Projects Home Page\" share a single branch and PR. Use `workflow` `start-epic` on the epic to create the shared branch before starting work.\n\n## What\n\nBuild the new Projects home page that replaces the kanban board at `/`. This is the main landing page showing all projects as a responsive card grid.\n\n## New Files\n\n### `src/routes/index.tsx`\n- Uses `useProjectsWithAIActivity()` hook (already exists in `src/lib/hooks/projects.ts`)\n- Renders a responsive grid of project cards\n- Each card shows: project name, path (truncated), epic count, ticket stats, AI activity glow\n- Click a card → navigate to `/projects/$projectId`\n- Empty state with \"Add Project\" CTA\n- Header with \"Projects\" title + \"New Project\" button (reuse existing `ProjectModal`)\n\n### `src/components/projects/ProjectCard.tsx`\n- Card component for the grid\n- Props: project data (ProjectWithAIActivity), onClick, onEdit\n- Shows color accent from `project.color`\n- AI glow animation when `hasActiveAI` (reuse existing keyframes from ProjectsPanel)\n- \"View All Tickets\" secondary action → navigate to `/board?project=X`\n\n## Reusable Code\n- `useProjectsWithAIActivity()` — `src/lib/hooks/projects.ts`\n- `ProjectModal` — existing modal for creating/editing projects\n- AI glow keyframes — from ProjectsPanel CSS\n\n## Acceptance Criteria\n\n- [ ] `/` renders a responsive grid of project cards\n- [ ] Each card shows project name, path, epic count, ticket stats\n- [ ] AI activity glow appears on cards with active sessions\n- [ ] Clicking a card navigates to `/projects/$projectId`\n- [ ] Empty state renders with \"Add Project\" CTA when no projects exist\n- [ ] \"New Project\" button opens ProjectModal\n- [ ] `pnpm type-check` passes\n- [ ] `pnpm lint` passes",
      "priority": "high",
      "tags": [
        "feature",
        "ui",
        "routing"
      ]
    },
    {
      "id": "f137d657-4a41-4a3b-9721-05fa3d493a52",
      "title": "Create Project detail page (`/projects/$projectId`)",
      "passes": false,
      "overview": "",
      "types": [],
      "designDecisions": [],
      "implementationGuide": [],
      "acceptanceCriteria": [
        "`/projects/:id` renders project header with name, path, color",
        "Back navigation returns to `/` (projects home)",
        "Epics are listed with ticket counts",
        "Clicking an epic navigates to `/board?project=X&epic=Y`",
        "\"View All Tickets\" navigates to `/board?project=X`",
        "\"Add Epic\" button opens EpicModal",
        "Empty state renders when project has no epics",
        "404/redirect when project ID doesn't exist",
        "`pnpm type-check` passes",
        "`pnpm lint` passes"
      ],
      "references": [
        "src/routes/projects.$projectId.tsx",
        "src/components/navigation/EpicListItem.tsx",
        "src/lib/hooks/projects.ts",
        "src/components/navigation/EpicDrillInView.tsx",
        "src/lib/filter-hooks.ts"
      ],
      "description": "## Shared Branch/PR\n\nAll tickets in epic \"Projects Home Page\" share a single branch and PR. Use `workflow` `start-epic` on the epic to create the shared branch before starting work.\n\n## What\n\nBuild the project detail page that shows a project's epics and provides drill-down navigation to the filtered kanban board.\n\n## New File\n\n### `src/routes/projects.$projectId.tsx`\n- Fetches project from `useProjects()` by matching `projectId` param\n- Shows project header (name, path, color) with back navigation to `/`\n- Lists epics using existing `EpicListItem` component from `src/components/navigation/EpicListItem.tsx`\n- Click epic → navigate to `/board?project=X&epic=Y` (uses existing URL filter system)\n- \"View All Tickets\" button → navigate to `/board?project=X`\n- \"Add Epic\" button (reuse existing epic creation modal)\n- Empty state: \"No epics yet — create your first epic to organize your tickets\"\n- Epic ticket counts via `useTickets` or a lightweight count query\n\n## Reusable Code\n- `useProjects()` — `src/lib/hooks/projects.ts`\n- `EpicListItem` — `src/components/navigation/EpicListItem.tsx`\n- `EpicDrillInView` — `src/components/navigation/EpicDrillInView.tsx` (reference for layout)\n- `EpicModal` — existing modal for creating/editing epics\n- URL filter system — `useFiltersWithUrl()` in `src/lib/filter-hooks.ts`\n\n## Acceptance Criteria\n\n- [ ] `/projects/:id` renders project header with name, path, color\n- [ ] Back navigation returns to `/` (projects home)\n- [ ] Epics are listed with ticket counts\n- [ ] Clicking an epic navigates to `/board?project=X&epic=Y`\n- [ ] \"View All Tickets\" navigates to `/board?project=X`\n- [ ] \"Add Epic\" button opens EpicModal\n- [ ] Empty state renders when project has no epics\n- [ ] 404/redirect when project ID doesn't exist\n- [ ] `pnpm type-check` passes\n- [ ] `pnpm lint` passes",
      "priority": "high",
      "tags": [
        "feature",
        "ui",
        "routing"
      ]
    },
    {
      "id": "c31f8560-4a3a-4aca-bd31-6643f12101a3",
      "title": "Update sidebar navigation and add home affordance",
      "passes": false,
      "overview": "",
      "types": [],
      "designDecisions": [],
      "implementationGuide": [],
      "acceptanceCriteria": [
        "Sidebar Board icon navigates to `/board`",
        "Sidebar Projects icon still opens slide-out panel (unchanged)",
        "Header logo/brand navigates to `/` (projects home)",
        "Keyboard shortcuts still work correctly",
        "`pnpm type-check` passes",
        "`pnpm lint` passes"
      ],
      "references": [
        "src/components/navigation/IconSidebar.tsx",
        "src/components/layout/AppHeader.tsx"
      ],
      "description": "## Shared Branch/PR\n\nAll tickets in epic \"Projects Home Page\" share a single branch and PR. Use `workflow` `start-epic` on the epic to create the shared branch before starting work.\n\n## What\n\nUpdate the sidebar and header to reflect the new routing structure. The Board icon should point to `/board` and users need a way to navigate back to the Projects home page.\n\n## Changes\n\n### `src/components/navigation/IconSidebar.tsx`\n- Change Board nav item path from `\"/\"` to `\"/board\"`\n- Keep existing sidebar items: Dashboard (1), Board (2), Projects (3, slide-out panel), Settings (4, modal)\n\n### `src/components/layout/AppHeader.tsx`\n- Add a clickable logo/brand element that navigates to `/` (projects home)\n- This gives users a consistent way back to the projects overview from anywhere\n\n## Acceptance Criteria\n\n- [ ] Sidebar Board icon navigates to `/board`\n- [ ] Sidebar Projects icon still opens slide-out panel (unchanged)\n- [ ] Header logo/brand navigates to `/` (projects home)\n- [ ] Keyboard shortcuts still work correctly\n- [ ] `pnpm type-check` passes\n- [ ] `pnpm lint` passes",
      "priority": "medium",
      "tags": [
        "ui",
        "navigation"
      ]
    },
    {
      "id": "bcfa7f67-d7c9-45a2-b92b-b90094c7c1ba",
      "title": "OVERVIEW 2: Minimalist List-Based Projects Homepage Redesign",
      "passes": false,
      "overview": "**Branch**: `feature/epic-040adfc0-projects-home-page` (continue on existing branch)\nThe current `/` (home) route displays projects in a card grid layout with borders, hover states, and chunky visual elements. This redesign introduces a more mature, elegant, minimalist approach:\n- **List-based layout** instead of grid cards (vertically stacked, no borders)\n- **Search bar** at the top to filter projects\n- **Inline metadata badges** under each project name (ticket counts, epic counts, AI status)\n- **Subtle hover effects** to indicate clickability\n- **Easy \"Add Project\" button** accessible in the header\n- **Settings icon** per-project for quick access to edit/delete\n**Goals**: Reduce visual noise, improve scannability, feel more professional and refined.\n---",
      "types": [],
      "designDecisions": [],
      "implementationGuide": [],
      "acceptanceCriteria": [
        "Implement as described",
        "Verify functionality works as expected"
      ],
      "references": [
        "src/lib/hooks/projects.ts",
        "src/components/projects/ProjectListItem.tsx",
        "src/routes/index.tsx",
        "src/lib/hooks/projects.ts:103",
        "src/lib/hooks/tickets.ts"
      ],
      "description": "# OVERVIEW 2: Minimalist List-Based Projects Homepage Redesign\n\n**Branch**: `feature/epic-040adfc0-projects-home-page` (continue on existing branch)\n\n## Context\n\nThe current `/` (home) route displays projects in a card grid layout with borders, hover states, and chunky visual elements. This redesign introduces a more mature, elegant, minimalist approach:\n\n- **List-based layout** instead of grid cards (vertically stacked, no borders)\n- **Search bar** at the top to filter projects\n- **Inline metadata badges** under each project name (ticket counts, epic counts, AI status)\n- **Subtle hover effects** to indicate clickability\n- **Easy \"Add Project\" button** accessible in the header\n- **Settings icon** per-project for quick access to edit/delete\n\n**Goals**: Reduce visual noise, improve scannability, feel more professional and refined.\n\n---\n\n## Implementation Tickets\n\n### Ticket 1: Extend Data Fetching to Include Ticket Counts\n- Extend `useProjectsWithAIActivity()` in `src/lib/hooks/projects.ts`\n- Add ticket count aggregation per project using `useMemo`\n\n### Ticket 2: Create ProjectListItem Component\n- New file: `src/components/projects/ProjectListItem.tsx`\n- Minimalist list item with color dot, name, metadata badges, hover actions\n- `MetadataBadge` subcomponent for inline ticket/epic/AI counts\n\n### Ticket 3: Redesign Homepage with Search and List Layout\n- Replace grid layout with centered vertical list in `src/routes/index.tsx`\n- Add search input for client-side project filtering\n- Wire up `ProjectListItem` and new data hooks\n- Update all container/layout styles\n\n---\n\n## Files to Modify\n\n1. `src/lib/hooks/projects.ts` — extend hook with ticket counts\n2. `src/components/projects/ProjectListItem.tsx` — NEW component\n3. `src/routes/index.tsx` — redesigned homepage\n\n## Existing Utilities to Reuse\n\n- `useProjectsWithAIActivity()` — `src/lib/hooks/projects.ts:103`\n- `useTickets()` — `src/lib/hooks/tickets.ts`\n- `openProjectModal()` — from AppLayout context\n- CSS variables — `--bg-hover`, `--text-tertiary`, `--spacing-*`, `--radius-*`, `--transition-fast`\n\n## Verification Steps\n\n1. Visual check at `localhost:4242/`\n2. `pnpm type-check` passes\n3. `pnpm test` passes\n4. Keyboard navigation works\n5. Search filters correctly\n6. Empty states display properly",
      "priority": "high",
      "tags": [
        "overview",
        "redesign",
        "homepage"
      ]
    },
    {
      "id": "dc8f3a3b-c327-437c-b852-b7f2ed33be59",
      "title": "Extend data fetching to include ticket counts per project",
      "passes": true,
      "overview": "The `useProjectsWithAIActivity()` hook returns projects with AI activity indicators but has no ticket count aggregation. The new minimalist homepage needs ticket counts displayed as inline metadata badges.",
      "types": [],
      "designDecisions": [],
      "implementationGuide": [],
      "acceptanceCriteria": [
        "`useProjectsWithAIActivity()` returns ticket counts per project",
        "Counts update reactively when tickets change",
        "`pnpm type-check` passes",
        "`pnpm test` passes"
      ],
      "references": [
        "src/lib/hooks/projects.ts",
        "projects.$projectId.tsx:23-31"
      ],
      "description": "# Extend Data Fetching to Include Ticket Counts Per Project\n\n**Branch**: `feature/epic-040adfc0-projects-home-page` (continue on existing branch)\n**Reference**: See OVERVIEW 2 ticket in this epic for the full redesign plan.\n\n## Context\n\nThe `useProjectsWithAIActivity()` hook returns projects with AI activity indicators but has no ticket count aggregation. The new minimalist homepage needs ticket counts displayed as inline metadata badges.\n\n## Implementation\n\n**File**: `src/lib/hooks/projects.ts`\n\n1. Import `useTickets()` from `hooks/tickets`\n2. Fetch all tickets once via existing hook\n3. Aggregate counts by project using `useMemo`:\n\n```typescript\nconst ticketCountByProject = useMemo(() => {\n  const counts = new Map<string, number>();\n  for (const ticket of tickets) {\n    counts.set(ticket.projectId, (counts.get(ticket.projectId) ?? 0) + 1);\n  }\n  return counts;\n}, [tickets]);\n```\n\n4. Return `ticketCountByProject` alongside existing return values\n\n## Pattern Reference\n\nFollow the same `useMemo` aggregation pattern used in `projects.$projectId.tsx` lines 23-31 (`ticketCountByEpic`).\n\n## Acceptance Criteria\n\n- [ ] `useProjectsWithAIActivity()` returns ticket counts per project\n- [ ] Counts update reactively when tickets change\n- [ ] `pnpm type-check` passes\n- [ ] `pnpm test` passes",
      "priority": "high",
      "tags": [
        "hooks",
        "data-fetching"
      ]
    },
    {
      "id": "e647e66b-953d-4b46-bab5-dde0491741b0",
      "title": "Create ProjectListItem component with metadata badges",
      "passes": true,
      "overview": "The homepage redesign replaces `ProjectCard` grid items with minimalist `ProjectListItem` components. Each item shows a color dot, project name, inline metadata badges, and hover-revealed settings action.",
      "types": [
        {
          "name": "ProjectListItemProps",
          "code": "interface ProjectListItemProps {\n  project: ProjectWithAIActivity;\n  ticketCount: number;\n  epicCount: number;\n  onClick: () => void;\n  onSettings: (e: React.MouseEvent) => void;\n}"
        }
      ],
      "designDecisions": [],
      "implementationGuide": [],
      "acceptanceCriteria": [
        "Component renders project name, color dot, metadata badges",
        "Hover reveals settings icon on right side",
        "Click navigates to project (via onClick prop)",
        "Settings click opens edit modal (via onSettings prop, stops propagation)",
        "AI active badge shows glow effect when applicable",
        "`pnpm type-check` passes"
      ],
      "references": [
        "src/components/projects/ProjectListItem.tsx"
      ],
      "description": "# Create ProjectListItem Component\n\n**Branch**: `feature/epic-040adfc0-projects-home-page` (continue on existing branch)\n**Reference**: See OVERVIEW 2 ticket in this epic for the full redesign plan.\n\n## Context\n\nThe homepage redesign replaces `ProjectCard` grid items with minimalist `ProjectListItem` components. Each item shows a color dot, project name, inline metadata badges, and hover-revealed settings action.\n\n## Implementation\n\n**New file**: `src/components/projects/ProjectListItem.tsx`\n\n### Structure\n\n```tsx\n<div container (hover background change)>\n  <span color-dot />\n  <div content>\n    <h3>Project Name</h3>\n    <div metadata-row>\n      <MetadataBadge icon={FileText} count={N} label=\"tickets\" />\n      <MetadataBadge icon={Folder} count={N} label=\"epics\" />\n      {hasActiveAI && <MetadataBadge icon={Bot} label=\"AI active\" glow />}\n    </div>\n  </div>\n  <div hover-actions (fade in on hover)>\n    <button Settings icon />\n  </div>\n</div>\n```\n\n### MetadataBadge subcomponent\n\nInline within the same file:\n- Icon + count + label\n- `glow` prop for AI badge accent color\n- Font size: `var(--font-size-xs)`, color: `var(--text-tertiary)`\n\n### Styling\n\n- No borders, transparent background\n- Hover: `var(--bg-hover)` background\n- Settings button: absolute positioned right, `opacity: 0` → `opacity: 1` on hover\n- Transition: `var(--transition-fast)`\n- Pattern reference: `ProjectItem.tsx` hover actions (lines 170-181) and `EpicListItem.tsx`\n\n### Props\n\n```typescript\ninterface ProjectListItemProps {\n  project: ProjectWithAIActivity;\n  ticketCount: number;\n  epicCount: number;\n  onClick: () => void;\n  onSettings: (e: React.MouseEvent) => void;\n}\n```\n\n## Acceptance Criteria\n\n- [ ] Component renders project name, color dot, metadata badges\n- [ ] Hover reveals settings icon on right side\n- [ ] Click navigates to project (via onClick prop)\n- [ ] Settings click opens edit modal (via onSettings prop, stops propagation)\n- [ ] AI active badge shows glow effect when applicable\n- [ ] `pnpm type-check` passes",
      "priority": "high",
      "tags": [
        "component",
        "ui"
      ]
    },
    {
      "id": "6300111e-979e-4ada-8ea4-40d96437cc80",
      "title": "Redesign homepage with search bar and minimalist list layout",
      "passes": true,
      "overview": "The homepage currently uses a card grid layout. This ticket replaces it with a centered, single-column list with a search bar for filtering.",
      "types": [],
      "designDecisions": [],
      "implementationGuide": [
        {
          "step": 1,
          "description": "Add Search Input",
          "files": [
            "SearchBar.tsx"
          ]
        },
        {
          "step": 2,
          "description": "Client-Side Filtering",
          "files": [],
          "codeTemplate": "const filteredProjects = useMemo(\n  () => projects.filter(p => \n    p.name.toLowerCase().includes(searchQuery.toLowerCase())\n  ),\n  [projects, searchQuery]\n);"
        },
        {
          "step": 3,
          "description": "Replace Grid with List",
          "files": []
        },
        {
          "step": 4,
          "description": "Layout Structure",
          "files": [],
          "codeTemplate": "<div pageContainer>\n  <header>\n    <h1>Projects</h1>\n    <button>+ New Project</button>\n  </header>\n  <div searchContainer>\n    <input placeholder=\"Search projects...\" />\n  </div>\n  <div listContainer>\n    {filteredProjects.map(project => (\n      <ProjectListItem ... />\n    ))}\n  </div>\n</div>"
        },
        {
          "step": 5,
          "description": "Updated Styles",
          "files": []
        },
        {
          "step": 6,
          "description": "Edge Cases",
          "files": []
        },
        {
          "step": 6,
          "description": "Edge Cases",
          "files": []
        }
      ],
      "acceptanceCriteria": [
        "Grid layout replaced with vertical list",
        "Search input filters projects by name",
        "Clear button appears when search has text",
        "Clicking project navigates to project detail",
        "\"New Project\" button opens create modal",
        "Settings icon opens edit modal",
        "Empty state displays properly",
        "No search results state displays properly",
        "`pnpm type-check` passes",
        "`pnpm test` passes",
        "Keyboard navigation works (Tab, Enter)"
      ],
      "references": [
        "src/routes/index.tsx"
      ],
      "description": "# Redesign Homepage with Search and List Layout\n\n**Branch**: `feature/epic-040adfc0-projects-home-page` (continue on existing branch)\n**Reference**: See OVERVIEW 2 ticket in this epic for the full redesign plan.\n**Depends on**: \"Extend data fetching\" and \"Create ProjectListItem component\" tickets.\n\n## Context\n\nThe homepage currently uses a card grid layout. This ticket replaces it with a centered, single-column list with a search bar for filtering.\n\n## Implementation\n\n**File**: `src/routes/index.tsx`\n\n### 1. Add Search Input\n\n- `useState` for search query\n- Simple `<input>` with search icon (lucide `Search`) and clear button (`X`)\n- Style: reuse patterns from `SearchBar.tsx` (lines 209-219)\n  - `background: var(--bg-primary)`\n  - `border: 1px solid var(--border-primary)`\n  - `border-radius: var(--radius-lg)`\n  - Search icon positioned left, clear button right\n\n### 2. Client-Side Filtering\n\n```typescript\nconst filteredProjects = useMemo(\n  () => projects.filter(p => \n    p.name.toLowerCase().includes(searchQuery.toLowerCase())\n  ),\n  [projects, searchQuery]\n);\n```\n\n### 3. Replace Grid with List\n\n- Remove grid layout (`display: grid`, `grid-template-columns`)\n- Add centered list container: `maxWidth: 900px`, `margin: 0 auto`\n- Replace `ProjectCard` usage with `ProjectListItem`\n- Wire up `ticketCountByProject` from extended hook\n\n### 4. Layout Structure\n\n```tsx\n<div pageContainer>\n  <header>\n    <h1>Projects</h1>\n    <button>+ New Project</button>\n  </header>\n  <div searchContainer>\n    <input placeholder=\"Search projects...\" />\n  </div>\n  <div listContainer>\n    {filteredProjects.map(project => (\n      <ProjectListItem ... />\n    ))}\n  </div>\n</div>\n```\n\n### 5. Updated Styles\n\n- Search container: padded, border-bottom, `var(--bg-secondary)` background\n- Search input wrapper: `maxWidth: 600px`, centered\n- List container: `maxWidth: 900px`, centered, scrollable\n\n### 6. Edge Cases\n\n- Empty state (no projects): show message with \"New Project\" CTA\n- No search matches: show \"No projects match\" message\n- Long names: text truncation with ellipsis\n\n## Acceptance Criteria\n\n- [ ] Grid layout replaced with vertical list\n- [ ] Search input filters projects by name\n- [ ] Clear button appears when search has text\n- [ ] Clicking project navigates to project detail\n- [ ] \"New Project\" button opens create modal\n- [ ] Settings icon opens edit modal\n- [ ] Empty state displays properly\n- [ ] No search results state displays properly\n- [ ] `pnpm type-check` passes\n- [ ] `pnpm test` passes\n- [ ] Keyboard navigation works (Tab, Enter)",
      "priority": "high",
      "tags": [
        "homepage",
        "search",
        "layout",
        "ui"
      ]
    }
  ],
  "projectContext": {
    "techStack": [
      "Framework: TanStack Start (React 19 + Vite + Nitro)",
      "Database: SQLite with better-sqlite3, Drizzle ORM",
      "Styling: Tailwind CSS v4",
      "State: TanStack Query for server state",
      "Drag & Drop: @dnd-kit"
    ],
    "dosDonts": [
      {
        "category": "Database Queries",
        "dos": [
          "Use Drizzle ORM: `db.select().from(tickets)`",
          "Use typed schema imports: `import { tickets } from \"../lib/schema\"`",
          "Use `eq()`, `and()`, `sql` from drizzle-orm for conditions",
          "Use transactions for multi-table operations: `db.transaction(() => {...})`",
          "Use `.get()` for single row, `.all()` for multiple"
        ],
        "donts": [
          "Raw SQL strings: `db.run(\"SELECT * FROM tickets\")`",
          "String-based table names",
          "String concatenation for WHERE clauses",
          "Multiple independent queries that should be atomic",
          "Assume query returns what you expect without checking"
        ]
      },
      {
        "category": "React & TanStack Query",
        "dos": [
          "Use `useQuery` with `queryKeys` for data fetching",
          "Use `useMutation` with `onSuccess` for state changes",
          "Invalidate queries after mutations: `queryClient.invalidateQueries({ queryKey: queryKeys.tickets })`",
          "Use centralized `queryKeys` object from `src/lib/hooks.ts`",
          "Create custom hooks in `src/lib/hooks.ts` for reusable query logic"
        ],
        "donts": [
          "`useState` + `useEffect` for fetched data",
          "Direct API calls without proper cache invalidation",
          "Manual cache manipulation or refetch after every change",
          "Hardcoded query key strings throughout components",
          "Duplicate query setup in multiple components"
        ]
      },
      {
        "category": "Styling Patterns",
        "dos": [
          "Use Tailwind classes for static styles: `className=\"p-4 bg-slate-800\"`",
          "Use CSS variables for theming: `var(--bg-primary)`, `var(--shadow-modal)`",
          "Reserve inline styles for dynamic/computed values: `style={{ width: `${percent}%` }}`",
          "Define shared style constants at module level for referential stability",
          "Use `React.CSSProperties` type for inline style objects when needed"
        ],
        "donts": [
          "Inline style objects for single-use styles",
          "Hardcoded colors that don't adapt to themes",
          "Mix Tailwind and inline styles inconsistently",
          "Create new objects inside components that are reused",
          "Untyped style objects that miss IDE autocomplete"
        ]
      },
      {
        "category": "Server Functions",
        "dos": [
          "Use `createServerFn({ method: \"GET\" })` for reads, `\"POST\"` for writes",
          "Use `.inputValidator()` for type-safe input handling",
          "Return typed data directly: `return db.select().from(tickets).all()`",
          "Use `ensureExists()` for required lookups: `ensureExists(project, \"Project\")`",
          "Import from `@tanstack/react-start` (not `@tanstack/react-start/server`)"
        ],
        "donts": [
          "Mix GET/POST inconsistently",
          "Access raw input without validation",
          "Wrap in unnecessary response objects",
          "Return null and let caller handle missing data",
          "Wrong import path"
        ]
      },
      {
        "category": "MCP Tool Implementation",
        "dos": [
          "Use Zod schemas for input validation: `{ ticketId: z.string() }`",
          "Return structured `{ content: [{ type: \"text\", text: ... }] }` format",
          "Set `isError: true` for error responses",
          "Use `log.info()` / `log.error()` from `../lib/logging.js`",
          "Include helpful error messages: `\"Project not found. Use list_projects to see available.\"`"
        ],
        "donts": [
          "Trust input without validation",
          "Return plain strings",
          "Return error text without the error flag",
          "`console.log` in MCP server code",
          "Generic \"Not found\" errors"
        ]
      },
      {
        "category": "Testing Patterns (Kent C. Dodds)",
        "dos": [
          "Test user behavior: what users see, click, and experience",
          "Integration tests for workflows: test components together",
          "Real database fixtures with actual schema",
          "Tests that fail when user-facing behavior breaks",
          "Ask: \"Does this test catch bugs users would encounter?\""
        ],
        "donts": [
          "Test implementation details, internal state, or private methods",
          "Unit tests for every function",
          "Excessive mocking of internals",
          "Tests that break on refactoring internals",
          "Chase 100% code coverage as a goal"
        ]
      }
    ],
    "verificationSteps": [
      "Run `pnpm type-check` - must pass with no errors",
      "Run `pnpm lint` - must pass with no errors",
      "Run `pnpm test` - all tests must pass",
      "Added tests for new functionality (ONLY tests that verify real user behavior - see Testing Philosophy above)",
      "Used typed error classes (not generic `Error`)",
      "Used Drizzle ORM (not raw SQL) - see DO/DON'T table above",
      "Followed existing patterns from DO/DON'T tables",
      "No hardcoded values that should be configurable",
      "Existing tests still pass",
      "No regressions in related functionality",
      "Updated tests if behavior changed",
      "Did not break backward compatibility (unless explicitly requested)",
      "Manually verified in browser at `localhost:4242`",
      "Checked responsive layout",
      "Verified TanStack Query invalidates and updates correctly",
      "Accessibility: keyboard navigation works, proper ARIA labels",
      "Migration file created via `pnpm db:generate`",
      "Migration tested with `pnpm db:migrate`",
      "Backup tested if schema changed (use `pnpm brain-dump backup` then test restore)",
      "Updated `src/lib/schema.ts` with proper types and constraints",
      "Tested tool via Claude Code integration",
      "Verified error responses are informative (see DO/DON'T table)",
      "Updated tool documentation if interface changed",
      "Added Zod schema for input validation",
      "All acceptance criteria from ticket met",
      "Work summary added via `comment` tool, `action: \"add\"` (for Ralph sessions)",
      "Session completed with appropriate outcome (for Ralph sessions)",
      "Committed with proper message format: `feat(<ticket-id>): <description>`"
    ]
  },
  "generatedAt": "2026-02-14T14:03:25.743Z",
  "epicTitle": "Projects Home Page",
  "epicDescription": "Introduce a structured Projects home page as the landing page with drill-down into epics. Navigation flow: Projects → Epics → Filtered Kanban Board. All tickets in this epic share a single branch and PR."
}

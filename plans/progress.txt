# Ralph Progress Log
# Previous entries archived to: archives/progress-20260118-015130.txt

- **Files:** 
  - .devcontainer/Dockerfile (NEW) - Main container definition
  - .devcontainer/init-firewall.sh (NEW) - Placeholder for firewall script
- **Notes:**
  - Base: node:20 with pnpm 9 via corepack
  - Build tools for better-sqlite3: python3, make, g++
  - Firewall tools: iptables, ipset, iproute2, dnsutils, aggregate, jq
  - Non-root node user with sudo access for init-firewall.sh
  - zsh with powerline10k and git-delta for better terminal experience
  - All acceptance criteria verified via docker build and container tests

---

### 2026-01-18 - Create .devcontainer/devcontainer.json (Ticket 10904211)
- **Ticket ID:** 10904211-7723-4438-bab5-cd497d64e849
- **Task:** Create devcontainer.json configuration
- **Success:** true
- **Commit:** ce3ab07
- **Files:** .devcontainer/devcontainer.json (NEW)
- **Notes:**
  - Uses pnpm 9 via corepack (not npm)
  - VS Code extensions: Claude Code, ESLint, Prettier, Tailwind, GitLens
  - NET_ADMIN/NET_RAW capabilities for firewall
  - Persistent volumes: pnpm store, bash history, Claude config
  - SQLite bind-mounted from host via BRAIN_DUMP_HOST_DATA_DIR
  - Port 4242 forwarded
  - Linux users: Set BRAIN_DUMP_HOST_DATA_DIR=~/.local/share/brain-dump
  - All acceptance criteria met and verified

---

### 2026-01-18 - Create .devcontainer/init-firewall.sh (Ticket 0f4a7e8c)
- **Ticket ID:** 0f4a7e8c-59d7-4c3b-be11-6de5bc24b2c1
- **Task:** Create firewall initialization script for network isolation
- **Success:** true
- **Commit:** 6dce724
- **Files:** .devcontainer/init-firewall.sh (UPDATED from placeholder)
- **Notes:**
  - Allowed: npm, GitHub, Anthropic API, telemetry, VS Code extensions
  - Preserves Docker DNS rules (127.0.0.11) before flushing
  - Uses ipset hash:net for efficient IP matching
  - Validates all IPs/CIDRs before adding
  - Uses REJECT instead of DROP for immediate feedback
  - Built-in verification tests for blocked/allowed domains
  - Full integration testing in ticket 9ac8e425

---

### 2026-01-17 20:45:49 - Session Timeout
- **Reason:** Timeout reached (2h limit)
- **Status:** Session terminated, work may be incomplete
- **Action:** Review progress and restart if needed

---

### 2026-01-18 - Add --devcontainer option to install.sh (Ticket 4bf8fa2a)
- **Ticket ID:** 4bf8fa2a-b19a-473e-af1e-19417eeb6270
- **Task:** Add --devcontainer option to install.sh
- **Success:** true
- **Commit:** c274099
- **Files:** install.sh (modified)
- **Notes:**
  - setup_devcontainer function: 110 lines
  - Checks .devcontainer/ files, Docker running, VS Code extension
  - Optionally pre-builds container image
  - Podman support as Docker alternative
  - Clear next steps for VS Code and CLI usage
  - All acceptance criteria met

---

### 2026-01-18 - Document Sandboxing Options (Ticket 27b01368)
- **Ticket ID:** 27b01368-abd1-47da-b2bc-b37185958648
- **Task:** Create comprehensive sandboxing documentation
- **Success:** true
- **Commit:** 081542b
- **Files:** docs/sandboxing.md (NEW)
- **Notes:**
  - Created docs/sandboxing.md with 430+ lines of documentation
  - Documents all three sandbox options:
    1. Native Sandbox (Claude Code) - bubblewrap/Seatbelt
    2. Devcontainer (Docker + VS Code) - firewall + isolation
    3. Ralph Sandbox - autonomous agent work
  - Quick comparison table and "When to Use Which" guidance
  - Troubleshooting sections for common issues
  - Security considerations and best practices
  - Extensive references including VS Code devcontainer docs
  - All 714 tests pass, type-check and lint clean

**EPIC STATUS: Sandboxing & Devcontainer Support**
- 6 of 8 tickets complete:
  - 3945ae33: Create .devcontainer/Dockerfile ✅
  - 10904211: Create .devcontainer/devcontainer.json ✅
  - 0f4a7e8c: Create .devcontainer/init-firewall.sh ✅
  - 822e5169: Add --sandbox option (already done) ✅
  - 4bf8fa2a: Add --devcontainer option ✅
  - 27b01368: Document sandboxing options ✅
  - 2c3b973e: Fix devcontainer configuration issues ✅
- Remaining:
  - 165e4cd5: Update uninstall.sh (low priority)
  - 9ac8e425: Test devcontainer with all three providers (requires manual testing)

---

### 2026-01-18 - Fix devcontainer configuration issues (Ticket 2c3b973e)
- **Ticket ID:** 2c3b973e-843f-4764-8841-46040c8a5795
- **Task:** Fix devcontainer configuration issues discovered during testing
- **Success:** true
- **Commit:** e30da3b
- **Files:** docs/sandboxing.md (modified)
- **Notes:**
  - Updated sandboxing documentation with Lima writable mount requirement
  - Added troubleshooting section for EROFS errors with Lima
  - Added troubleshooting section for malformed DOCKER_HOST values
  - Verified check_docker_host() catches malformed values (sockexport, .socketfoo, sockert)
  - Verified XDG paths correctly mounted in devcontainer.json
  - Type-check and lint pass; tests pass when run individually
  - Acceptance criteria met:
    - ✅ Update sandboxing documentation with Lima writable mount requirement
    - ✅ Verify MCP server works inside devcontainer after rebuild (XDG paths correct)
    - ✅ Test that check_docker_host() catches malformed values
    - ⏳ Ensure all three providers work in devcontainer (requires manual testing - ticket 9ac8e425)

---

### 2026-01-19 12:58:55 - Session Timeout
- **Reason:** Timeout reached (2h limit)
- **Status:** Session terminated, work may be incomplete
- **Action:** Review progress and restart if needed

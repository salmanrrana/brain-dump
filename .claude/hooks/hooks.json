{
  "description": "Brain Dump hooks: enforce branch workflow and automatic code review",
  "hooks": {
    "PreToolUse": [
      {
        "matcher": "Edit|Write|NotebookEdit",
        "hooks": [
          {
            "type": "command",
            "command": "branch=$(git rev-parse --abbrev-ref HEAD 2>/dev/null); if [ \"$branch\" = \"main\" ] || [ \"$branch\" = \"master\" ] || [ \"$branch\" = \"develop\" ]; then echo '{\"ok\": false, \"reason\": \"BLOCKED: You are on the '\"$branch\"' branch. Before making code changes, you MUST call start_ticket_work(ticketId) via MCP to create a feature branch. This ensures all work is properly tracked and can be reviewed via PR. If you do not have a ticket ID, create a ticket first using create_ticket().\"}'; else echo '{\"ok\": true}'; fi"
          }
        ]
      }
    ],
    "Stop": [
      {
        "hooks": [
          {
            "type": "prompt",
            "prompt": "You are evaluating whether to trigger automatic code review after Claude's response.\n\nAnalyze the transcript to determine if significant source code changes were made using Write, Edit, or NotebookEdit tools.\n\nCode changes that REQUIRE review:\n- New source files (.ts, .tsx, .js, .jsx, .py, .go, .rs, etc.)\n- Modified source files\n- New or modified test files\n\nChanges that do NOT require review:\n- Documentation files (.md, README, etc.)\n- Configuration files (package.json, tsconfig.json, etc.)\n- Git operations (commits, merges)\n- Reading/searching files only\n- Conversation-only responses\n- If review agents have ALREADY been run in this conversation turn\n\nIf significant code changes were made AND review agents have NOT yet been run, respond:\n{\n  \"ok\": false,\n  \"reason\": \"MANDATORY: Code changes detected. You MUST now run /review (or launch all three review agents in parallel: pr-review-toolkit:code-reviewer, pr-review-toolkit:silent-failure-hunter, and pr-review-toolkit:code-simplifier) before responding to the user. This is required by project policy in CLAUDE.md.\"\n}\n\nIf no code changes, only config/docs changes, or review agents have already been run, respond:\n{\n  \"ok\": true\n}"
          }
        ]
      }
    ]
  }
}
